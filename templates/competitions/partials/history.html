<!-- HTMX partial: Submission history table -->
{% if submissions %}
<div class="overflow-x-auto">
    <table class="table table-zebra">
        <thead>
            <tr>
                <th>#</th>
                <th>Submitted At</th>
                <th>Status</th>
                <th>Public Score</th>
                <th>Final</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for submission in submissions %}
            <tr class="{% if submission.is_final_selection %}bg-primary/10{% endif %}">
                <td>{{ submission.id }}</td>
                <td>{{ submission.submitted_at|date:"Y-m-d H:i" }}</td>
                <td>
                    {% if submission.status == 'PENDING' %}
                    <span class="badge badge-ghost">Pending</span>
                    {% elif submission.status == 'PROCESSING' %}
                    <span class="badge badge-info">
                        <span class="loading loading-spinner loading-xs mr-1"></span>
                        Processing
                    </span>
                    {% elif submission.status == 'SUCCESS' %}
                    <span class="badge badge-success">Success</span>
                    {% else %}
                    <span class="badge badge-error tooltip" data-tip="{{ submission.error_message }}">
                        Failed
                    </span>
                    {% endif %}
                </td>
                <td>
                    {% if submission.public_score is not None %}
                    <span class="font-mono font-bold">{{ submission.public_score|floatformat:4 }}</span>
                    {% else %}
                    <span class="text-gray-400">-</span>
                    {% endif %}
                </td>
                <td>
                    {% if submission.is_final_selection %}
                    <span class="badge badge-accent">âœ“ Final</span>
                    {% else %}
                    {% if submission.status == 'SUCCESS' %}
                    <button class="btn btn-xs btn-outline" hx-post="{% url 'set_final_selection' submission.id %}"
                        hx-target="closest tr" hx-swap="outerHTML"
                        hx-confirm="Are you sure you want to set this as the final selection?">
                        Set as Final
                    </button>
                    {% endif %}
                    {% endif %}
                </td>
                <td>
                    <a href="{{ submission.prediction_file.url }}" class="btn btn-xs btn-ghost" download>
                        ðŸ“¥
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="text-center py-8 text-gray-500">
    No submission history
</div>
{% endif %}